<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Freight CO2 Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #2c5282;
            text-align: center;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        @media (min-width: 768px) {
            .container {
                grid-template-columns: 1fr 1fr;
            }
        }
        .card {
            background-color: #f7f7f7;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #3182ce;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        button:hover {
            background-color: #2c5282;
        }
        button.secondary {
            background-color: #718096;
        }
        button.secondary:hover {
            background-color: #4a5568;
        }
        .results {
            margin-top: 30px;
        }
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }
        .green-text {
            color: #38a169;
            font-weight: bold;
        }
        .flex-container {
            display: flex;
            gap: 10px;
        }
        .flex-container > div {
            flex: 1;
        }
        .hidden {
            display: none;
        }
        .map-placeholder {
            background-color: #ebf8ff;
            border: 1px solid #bee3f8;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Air Freight CO2 Calculator</h1>
    
    <div class="container">
        <!-- Route Information -->
        <div class="card">
            <h2>Route Information</h2>
            
            <div class="form-group">
                <label for="fromAirport">From Airport (IATA code)</label>
                <select id="fromAirport">
                    <option value="">Select departure airport</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="toAirport">To Airport (IATA code)</label>
                <select id="toAirport">
                    <option value="">Select arrival airport</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="numContainers">Number of Containers</label>
                <input type="number" id="numContainers" value="150" min="1">
            </div>
            
            <div class="form-group">
                <label for="cargoWeight">Cargo Weight per Container (kg)</label>
                <input type="number" id="cargoWeight" value="1000" min="0">
            </div>
            
            <button id="calculateBtn">Calculate Emissions</button>
            
            <p id="errorMsg" class="hidden" style="color: red; margin-top: 10px;"></p>
        </div>
        
        <!-- Assumptions -->
        <div class="card">
            <h2>Assumptions</h2>
            
            <div class="flex-container">
                <div class="form-group">
                    <label for="swissWeight">Swiss Airtainer Weight (kg)</label>
                    <input type="number" id="swissWeight" value="590" min="0">
                </div>
                
                <div class="form-group">
                    <label for="competitorWeight">Competitor Weight (kg)</label>
                    <input type="number" id="competitorWeight" value="650" min="0">
                </div>
            </div>
            
            <div class="flex-container">
                <div class="form-group">
                    <label for="emissionFactor">Emission Factor (kg CO2/tonne-km)</label>
                    <input type="number" id="emissionFactor" value="0.6" step="0.01" min="0">
                </div>
                
                <div class="form-group">
                    <label for="treeFactor">Tree Absorption (kg CO2/tree)</label>
                    <input type="number" id="treeFactor" value="25" step="0.1" min="0.1">
                </div>
            </div>
            
            <div class="flex-container">
                <div class="form-group">
                    <label for="carFactor">Car Emissions (tonnes CO2/car)</label>
                    <input type="number" id="carFactor" value="4.6" step="0.1" min="0.1">
                </div>
                
                <div class="form-group">
                    <label for="costFactor">Cost of Carbon ($/tonne)</label>
                    <input type="number" id="costFactor" value="30" step="0.1" min="0">
                </div>
            </div>
            
            <button id="resetBtn" class="secondary">Reset Assumptions</button>
        </div>
    </div>
    
    <!-- Results Section -->
    <div id="resultsContainer" class="results hidden">
        <h2>Results</h2>
        
        <div class="container">
            <div class="card">
                <p><strong>Distance:</strong> <span id="distanceResult">0</span> km</p>
                <p><strong>Swiss Airtainer Emissions:</strong> <span id="swissEmissionsResult">0</span> kg CO2</p>
                <p><strong>Competitor Emissions:</strong> <span id="competitorEmissionsResult">0</span> kg CO2</p>
                <p class="green-text">Emissions Savings: <span id="savingsResult">0</span> kg CO2</p>
                
                <h3>Environmental Equivalents</h3>
                <p><strong>Trees needed to absorb this CO2:</strong> <span id="treeEquivalentResult">0</span></p>
                <p><strong>Equivalent to removing cars:</strong> <span id="carEquivalentResult">0</span></p>
                <p><strong>Cost savings:</strong> $<span id="costSavingsResult">0</span></p>
            </div>
            
            <div class="card">
                <h3>Emissions Comparison</h3>
                <div class="chart-container">
                    <canvas id="emissionsChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="card" style="margin-top: 20px;">
            <h3>Flight Route</h3>
            <div class="map-placeholder">
                <p>This is where an interactive map would go in a full implementation,
                showing the route between <span id="fromAirportCode"></span> and <span id="toAirportCode"></span>.</p>
                <p style="font-size: 14px; color: #718096; margin-top: 10px;">
                    In a complete implementation, you would integrate with a mapping library like Leaflet or Google Maps.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Airport data
        const airports = [
            { iata: 'ZRH', name: 'Zurich Airport', lat: 47.4647, lng: 8.5492 },
            { iata: 'JFK', name: 'John F. Kennedy International Airport', lat: 40.6413, lng: -73.7781 },
            { iata: 'LHR', name: 'London Heathrow', lat: 51.4700, lng: -0.4543 },
            { iata: 'CDG', name: 'Paris Charles de Gaulle', lat: 49.0097, lng: 2.5479 },
            { iata: 'SIN', name: 'Singapore Changi', lat: 1.3644, lng: 103.9915 },
            { iata: 'HKG', name: 'Hong Kong International', lat: 22.3080, lng: 113.9185 },
            { iata: 'DXB', name: 'Dubai International', lat: 25.2532, lng: 55.3657 },
            { iata: 'LAX', name: 'Los Angeles International', lat: 33.9416, lng: -118.4085 },
            { iata: 'PEK', name: 'Beijing Capital International', lat: 40.0799, lng: 116.6031 },
            { iata: 'FRA', name: 'Frankfurt Airport', lat: 50.0379, lng: 8.5622 }
        ];

        // Chart instance
        let emissionsChart;
        
        // DOM Elements
        const fromAirportSelect = document.getElementById('fromAirport');
        const toAirportSelect = document.getElementById('toAirport');
        const numContainersInput = document.getElementById('numContainers');
        const cargoWeightInput = document.getElementById('cargoWeight');
        const swissWeightInput = document.getElementById('swissWeight');
        const competitorWeightInput = document.getElementById('competitorWeight');
        const emissionFactorInput = document.getElementById('emissionFactor');
        const treeFactorInput = document.getElementById('treeFactor');
        const carFactorInput = document.getElementById('carFactor');
        const costFactorInput = document.getElementById('costFactor');
        const calculateBtn = document.getElementById('calculateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const errorMsg = document.getElementById('errorMsg');
        const resultsContainer = document.getElementById('resultsContainer');
        
        // Populate airport dropdowns
        function populateAirports() {
            airports.forEach(airport => {
                const option1 = document.createElement('option');
                option1.value = airport.iata;
                option1.textContent = `${airport.iata} - ${airport.name}`;
                fromAirportSelect.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = airport.iata;
                option2.textContent = `${airport.iata} - ${airport.name}`;
                toAirportSelect.appendChild(option2);
            });
        }
        
        // Calculate distance using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radius of the Earth in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c; // Distance in km
        }
        
        // Calculate emissions
        function calculateEmissions() {
            const fromAirportCode = fromAirportSelect.value;
            const toAirportCode = toAirportSelect.value;
            const numContainers = parseInt(numContainersInput.value) || 150;
            const cargoWeight = parseInt(cargoWeightInput.value) || 1000;
            const swissWeight = parseInt(swissWeightInput.value) || 590;
            const competitorWeight = parseInt(competitorWeightInput.value) || 650;
            const emissionFactor = parseFloat(emissionFactorInput.value) || 0.6;
            const treeFactor = parseFloat(treeFactorInput.value) || 25;
            const carFactor = parseFloat(carFactorInput.value) || 4.6;
            const costFactor = parseFloat(costFactorInput.value) || 30;
            
            // Validate inputs
            if (!fromAirportCode || !toAirportCode) {
                errorMsg.textContent = 'Please select both departure and arrival airports';
                errorMsg.classList.remove('hidden');
                return;
            }
            
            const fromAirport = airports.find(a => a.iata === fromAirportCode);
            const toAirport = airports.find(a => a.iata === toAirportCode);
            
            // Calculate distance
            const distance = calculateDistance(
                fromAirport.lat, fromAirport.lng,
                toAirport.lat, toAirport.lng
            );
            
            // Calculate emissions
            const swissEmissions = numContainers * (swissWeight + cargoWeight) * distance * emissionFactor / 1000;
            const competitorEmissions = numContainers * (competitorWeight + cargoWeight) * distance * emissionFactor / 1000;
            const savings = competitorEmissions - swissEmissions;
            
            // Calculate equivalents
            const treeEquivalent = Math.round(savings / treeFactor);
            const carEquivalent = (savings / 1000) / carFactor;
            const costSavings = (savings / 1000) * costFactor;
            
            // Update results
            document.getElementById('distanceResult').textContent = Math.round(distance);
            document.getElementById('swissEmissionsResult').textContent = (Math.round(swissEmissions * 100) / 100).toFixed(2);
            document.getElementById('competitorEmissionsResult').textContent = (Math.round(competitorEmissions * 100) / 100).toFixed(2);
            document.getElementById('savingsResult').textContent = (Math.round(savings * 100) / 100).toFixed(2);
            document.getElementById('treeEquivalentResult').textContent = treeEquivalent;
            document.getElementById('carEquivalentResult').textContent = (Math.round(carEquivalent * 100) / 100).toFixed(2);
            document.getElementById('costSavingsResult').textContent = (Math.round(costSavings * 100) / 100).toFixed(2);
            
            // Update map placeholder
            document.getElementById('fromAirportCode').textContent = fromAirportCode;
            document.getElementById('toAirportCode').textContent = toAirportCode;
            
            // Show results
            resultsContainer.classList.remove('hidden');
            errorMsg.classList.add('hidden');
            
            // Update chart
            updateChart(swissEmissions, competitorEmissions);
        }
        
        // Update or create the chart
        function updateChart(swissEmissions, competitorEmissions) {
            const ctx = document.getElementById('emissionsChart').getContext('2d');
            
            // Destroy previous chart if it exists
            if (emissionsChart) {
                emissionsChart.destroy();
            }
            
            // Create new chart
            emissionsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Swiss Airtainer', 'Competitors'],
                    datasets: [{
                        label: 'CO2 Emissions (kg)',
                        data: [
                            Math.round(swissEmissions * 100) / 100,
                            Math.round(competitorEmissions * 100) / 100
                        ],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'CO2 Emissions (kg)'
                            }
                        }
                    }
                }
            });
        }
        
        // Reset assumptions to defaults
        function resetAssumptions() {
            swissWeightInput.value = 590;
            competitorWeightInput.value = 650;
            emissionFactorInput.value = 0.6;
            treeFactorInput.value = 25;
            carFactorInput.value = 4.6;
            costFactorInput.value = 30;
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            populateAirports();
            calculateBtn.addEventListener('click', calculateEmissions);
            resetBtn.addEventListener('click', resetAssumptions);
        });
    </script>
</body>
</html>